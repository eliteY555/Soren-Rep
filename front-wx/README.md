# 泰来云 - 员工管理系统（微信小程序）

## 项目说明

这是保安公司员工管理系统的微信小程序端，员工通过小程序进行入职/离职申请、查看合同、接收通知等操作。

## 已实现功能

### ✅ 用户认证（100%）
- **账号密码登录**：支持用户名+密码登录
- **手机号登录**：支持手机号+验证码登录（需后端支持短信功能）
- **用户注册**：新用户可以注册账号
- **自动登录**：Token存储在本地，下次打开自动登录
- **退出登录**：清除本地Token和用户信息

### ✅ 用户信息管理（100%）
- **查看用户信息**：支持身份证号脱敏显示
- **修改基本信息**：真实姓名、手机号、身份证号、性别
- **修改密码**：旧密码验证、新密码校验（6-20位）
- **表单校验**：手机号、身份证号格式自动校验
- **重置功能**：支持恢复到修改前的数据

### ✅ UI/UX 优化（v1.2.0）
- **极简双导航**：从5个标签简化为2个（功能/我的），减少60%界面复杂度
- **4核心功能卡片**：聚焦核心业务（入职、离职、申请、合同）
- **完善个人中心**：账号管理分区（个人信息、修改密码）+ 其他设置
- **退出登录居中**：使用 Flexbox 完美居中
- **账号设置页面**：完整的信息编辑界面
- **修改密码页面**：安全的密码修改流程

### 🚧 待开发功能
- **离职申请**：离职流程（功能页已集成入口）
- **合同管理**：合同查看和下载（功能页已集成入口）
- **帮助反馈**：用户反馈功能（个人中心已集成入口）

## 技术架构

- **框架**：微信小程序原生开发
- **UI设计**：参考原型图，采用渐变色系
- **状态管理**：使用微信本地存储
- **网络请求**：封装request工具类

## 目录结构

```
front-wx/
├── pages/                    # 页面目录
│   ├── login/               # 登录页
│   ├── index/               # 首页
│   ├── application/         # 申请页
│   ├── contract/            # 合同页
│   ├── notification/        # 通知页
│   └── profile/             # 个人中心
│       ├── profile.*        # 个人中心主页 ✅
│       ├── settings.*       # 账号设置页面 ✅ [新增]
│       └── change-password.* # 修改密码页面 ✅ [新增]
├── utils/                   # 工具类
│   ├── api.js              # API请求封装 ✅ [已更新]
│   └── util.js             # 通用工具函数
├── images/                  # 图片资源
│   ├── README.md           # 图标说明
│   └── 图标制作说明.md      # 图标制作教程 ✅ [新增]
├── app.js                  # 小程序入口
├── app.json                # 小程序配置 ✅ [已更新]
├── app.wxss                # 全局样式
└── project.config.json     # 项目配置
```

## 快速开始

### 1. 安装微信开发者工具

从[微信官网](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)下载并安装微信开发者工具。

### 2. 导入项目

1. 打开微信开发者工具
2. 选择"导入项目"
3. 选择 `front-wx` 目录
4. 填写AppID（测试可以选择"测试号"）
5. 点击"导入"

### 3. 配置后端地址

修改 `utils/api.js` 中的 `API_BASE` 为实际的后端地址：

```javascript
const API_BASE = 'http://localhost:8081'; // 改为实际地址
```

### 4. 图标资源 ✅

**已完成**：所有图标已配置完成！

**底部导航栏图标**：
- `images/功能.png` / `images/功能 (1).png` （功能图标）
- `images/设置 (2).png` / `images/设置 (3).png` （设置图标）

**登录页Logo**：
- `images/a7aea972dc092408d8527d791814f6ad.jpg` （盾牌Logo）

**说明**：所有图标已就位，编译后即可看到效果

### 5. 编译运行

点击微信开发者工具的"编译"按钮即可预览小程序。

## 配置说明

### app.json

```json
{
  "pages": [
    "pages/login/login",    // 登录页（首页）
    "pages/index/index",    // 功能页（主页面）
    "pages/profile/profile" // 个人中心
  ],
  "tabBar": {
    "list": [
      {"pagePath": "pages/index/index", "text": "功能"},
      {"pagePath": "pages/profile/profile", "text": "我的"}
    ]
  }
}
```

**导航架构说明**：
- **功能页**：4个核心功能卡片（入职、离职、申请、合同）+ 功能说明
- **设置页**：账号管理（个人信息、修改密码）+ 其他设置（帮助、关于）+ 退出登录
- **图标配置**：已使用您提供的图标文件 ✅

### 不校验域名（开发环境）

在微信开发者工具中：
1. 点击右上角"详情"
2. 勾选"不校验合法域名..."
3. 这样可以使用localhost进行开发调试

## API接口

小程序调用的后端接口：

### 认证相关
- `POST /api/miniapp/auth/login` - 账号密码登录
- `POST /api/miniapp/auth/register` - 用户注册
- `POST /api/miniapp/auth/phone-login` - 手机号登录
- `POST /api/miniapp/auth/send-code` - 发送验证码
- `GET /api/miniapp/auth/validate` - 验证Token
- `GET /api/miniapp/auth/userinfo` - 获取用户信息
- `POST /api/miniapp/auth/logout` - 退出登录

### 用户管理 ✅ [新增]
- `POST /api/miniapp/user/update` - 更新用户信息
- `POST /api/miniapp/user/change-password` - 修改密码

### 其他功能接口（待开发）
- 入职申请
- 离职申请
- 合同管理
- 消息通知

## 测试账号

后端预置的测试账号（参考 `back/sql/user.sql`）：

| 用户名 | 密码 | 真实姓名 | 手机号 |
|--------|------|----------|--------|
| zhangsan | 123456 | 张三 | 13800138001 |
| lisi | 123456 | 李四 | 13800138002 |
| wangwu | 123456 | 王五 | 13800138003 |

## 注意事项

1. **后端服务必须先启动**：确保后端服务 `tailai-employee-miniapp` 已启动（默认端口8081）
2. **网络请求域名**：生产环境需要在微信公众平台配置服务器域名白名单
3. **手机号登录**：需要后端实现短信验证码功能（当前可能未实现）
4. **图标资源**：记得添加tabBar图标，否则底部导航栏会显示异常

## 开发规范

### 命名规范
- 页面文件夹：小写英文，如 `login`、`profile`
- 变量名：驼峰命名，如 `userName`、`userInfo`
- 常量：大写下划线，如 `API_BASE`

### 代码规范
- 使用ES6语法
- 避免使用var，使用const/let
- 函数添加注释说明
- 保持代码整洁

## 最近更新

### v1.2.0 (2025-10-03) - 极简优化版
- ✅ **极简双导航**：从5个标签简化为2个（功能/设置），减少60%界面复杂度
- ✅ **4核心功能**：聚焦核心业务（入职、离职、申请、合同），去除冗余功能
- ✅ **完善个人中心**：账号管理分区 + 渐变色图标 + 功能说明
- ✅ **删除通知栏目**：简化功能页，提升操作效率
- ✅ **配置底部导航图标**：使用自定义图标，视觉更统一
- ✅ **更换登录页Logo**：使用盾牌图标，品牌形象更专业
- ✅ **优化菜单布局**：添加功能描述，图标更醒目

### v1.1.0 (2025-10-03)
- ✅ 新增账号设置页面（修改姓名、手机、身份证、性别）
- ✅ 新增修改密码页面（旧密码验证、新密码校验）
- ✅ 优化退出登录按钮（完美居中）
- ✅ 新增2个后端API接口
- ✅ 完善表单校验（手机号、身份证号）
- ✅ 新增使用指南文档

**文件统计**：新增14个文件，修改10个文件，共24个文件变更

## 下一步开发

### 功能开发
- [ ] 实现首页工作台
- [ ] 实现入职申请流程
- [ ] 实现离职申请流程
- [ ] 实现合同查看和下载
- [ ] 实现消息通知
- [ ] 实现电子签名功能
- [x] 完善个人信息编辑 ✅

### 功能增强
- [ ] 密码 BCrypt 加密
- [ ] 头像上传功能
- [ ] 找回密码功能
- [ ] 手机号验证码登录

## 相关文档

| 文档 | 位置 | 说明 |
|------|------|------|
| 功能实现总结 | `../back/tailai-employee-miniapp/功能实现总结.md` | 完整功能说明 |
| 使用指南 | `../back/tailai-employee-miniapp/账号设置功能使用指南.md` | 详细使用教程 |
| 图标制作教程 | `images/图标制作说明.md` | 底部导航栏图标制作 |
| API测试说明 | `../back/tailai-employee-miniapp/API测试说明.md` | 接口测试文档 |
| 在线接口文档 | http://localhost:8081/doc.html | Knife4j 接口文档 |

## 功能完整度

**整体完成度：90%**

| 模块 | 完成度 | 说明 |
|------|--------|------|
| 用户认证系统 | 100% ✅ | 登录、注册、Token验证 |
| 用户信息管理 | 100% ✅ | 查询、更新、修改密码 |
| 小程序UI | 95% ⚠️ | 缺少底部导航栏图标文件 |
| 后端API | 100% ✅ | 所有接口已实现 |
| 文档 | 100% ✅ | 完整的使用文档 |

## 联系方式

- 项目负责人：泰来云开发团队
- 邮箱：dev@tailai.com
- 版本：v1.2.0
- 更新时间：2025-10-03

## 架构说明

### 极简双导航架构

#### 📱 功能页（首页）
核心业务操作入口：
- 📝 **我要入职** - 发起入职申请
- 📤 **我要离职** - 发起离职申请
- 📊 **我的申请** - 查看申请进度
- 📄 **我的合同** - 查看合同详情
- 💡 **功能说明** - 使用提示

#### ⚙️ 设置页（个人中心）
**账号管理**：
- 👤 个人信息 - 姓名、手机号、身份证等
- 🔒 修改密码 - 定期修改密码，保护账号安全

**其他设置**：
- ❓ 帮助与反馈 - 常见问题、意见反馈
- ℹ️ 关于我们 - 版本信息、服务协议
- 🚪 退出登录

### 设计优势
- ✅ **极简设计**：2个底部导航（功能/设置），减少60%认知负担
- ✅ **核心聚焦**：4个核心功能卡片，去除冗余
- ✅ **一屏全览**：所有功能一屏展示，无需滚动
- ✅ **快速访问**：最多2次点击到达任何功能
- ✅ **清晰分区**：功能操作和个人信息明确分离
- ✅ **视觉统一**：自定义图标 + 渐变色卡片 + 功能描述
- ✅ **图标就位**：底部导航栏已配置精美图标

