"use strict";(self["webpackChunkzhenyitong_online_medical"]=self["webpackChunkzhenyitong_online_medical"]||[]).push([[627],{4627:function(t,e,r){r.r(e),r.d(e,{default:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-container"},[e("div",{staticClass:"card-container"},[e("div",{staticClass:"card-header"},[t._v("医师列表")]),e("div",{staticClass:"card-body"},[e("div",{staticClass:"search-area"},[e("el-form",{attrs:{inline:!0}},[e("el-form-item",[e("el-select",{attrs:{placeholder:"请选择地区",clearable:""},model:{value:t.regionValue,callback:function(e){t.regionValue=e},expression:"regionValue"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",[e("el-select",{attrs:{placeholder:"请选择医院",clearable:""},model:{value:t.hospitalValue,callback:function(e){t.hospitalValue=e},expression:"hospitalValue"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",[e("el-select",{attrs:{placeholder:"请选择科室",clearable:""},model:{value:t.departmentValue,callback:function(e){t.departmentValue=e},expression:"departmentValue"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("查询")]),e("el-button",{on:{click:t.onReset}},[t._v("重置")])],1)],1)],1),e("div",{staticClass:"doctor-list"},[e("el-row",{attrs:{gutter:20}},t._l(t.displayedDoctors,(function(r,a){return e("el-col",{key:a,attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[e("div",{staticClass:"doctor-card"},[e("div",{staticClass:"doctor-avatar"},[e("img",{attrs:{src:r.avatar,alt:"doctor avatar"}})]),e("div",{staticClass:"doctor-info"},[e("div",{staticClass:"doctor-name"},[t._v(" "+t._s(r.name)+" "),e("span",{staticClass:"doctor-tag"},[t._v(t._s(r.department))])]),e("div",{staticClass:"doctor-hospital"},[e("i",{staticClass:"el-icon-location"}),t._v(" "+t._s(r.hospital)+" ")]),e("div",{staticClass:"doctor-description"},[t._v(" 简介："+t._s(r.description)+" ")])])])])})),1)],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":10,"page-sizes":[10,20],layout:"total, prev, pager, next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)])])])},o=[],n=(r(1454),r(7909)),i=r(5720),s={name:"DocList",data(){return{loading:!1,regionValue:"",hospitalValue:"",departmentValue:"",currentPage:1,pageSize:10,total:0,options:[{value:"option1",label:"选项1"},{value:"option2",label:"选项2"},{value:"option3",label:"选项3"}],doctorsData:[]}},computed:{displayedDoctors(){return this.doctorsData}},methods:{handleSizeChange(t){this.pageSize=t,this.fetchData()},handleCurrentChange(t){this.currentPage=t,this.fetchData()},onSubmit(){this.currentPage=1,this.fetchData()},onReset(){this.regionValue="",this.hospitalValue="",this.departmentValue="",this.currentPage=1,this.fetchData()},async fetchData(){this.loading=!0;try{console.log("开始加载医生数据...");const t={page:this.currentPage,pageSize:this.pageSize};this.regionValue&&(t.cityName=this.regionValue),this.hospitalValue&&(t.hospitalName=this.hospitalValue),this.departmentValue&&(t.departmentName=this.departmentValue),console.log("查询参数:",t);const e=await(0,n.Gn)(t);e&&e.doctorList?(this.doctorsData=e.doctorList.map((t=>({name:t.doctorName,department:t.departmentName||"未设置科室",hospital:t.hospitalName||"未设置医院",description:t.introduction||"暂无简介",avatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",doctorId:t.doctorId}))),this.total=e.total||0,console.log(`成功加载 ${this.doctorsData.length} 名医生数据，总数: ${this.total}`)):(console.warn("未能获取医生数据或数据格式不正确:",e),this.doctorsData=[],this.total=0)}catch(t){if((0,i.tq)(t))return void console.log("医生列表加载请求已取消");console.error("获取医生列表失败:",t),this.$message.error("获取医生列表失败，请稍后再试"),this.doctorsData=[],this.total=0}finally{this.loading=!1}}},mounted(){this.fetchData()},beforeDestroy(){}},l=s,c=r(1656),u=(0,c.A)(l,a,o,!1,null,"4ddf0fda",null),d=u.exports},7909:function(t,e,r){r.d(e,{BL:function(){return n},Gn:function(){return l},Q9:function(){return i},QQ:function(){return c},a2:function(){return s}});r(1454);var a=r(5720);const o={info:new Map,list:null,timestamp:0,EXPIRY:6e5,isExpired(){return Date.now()-this.timestamp>this.EXPIRY},reset(){this.info.clear(),this.list=null,this.timestamp=0}};function n(t){return o.reset(),(0,a.Ay)({url:"/doctor/update",method:"post",data:t}).catch((t=>((0,a.tq)(t)||console.error("更新医生信息失败:",t),Promise.reject(t))))}function i(t){return t?o.info.has(t)&&!o.isExpired()?(console.log(`使用缓存的医生信息 (userId: ${t})`),Promise.resolve(o.info.get(t))):(console.log(`从服务器获取医生信息 (userId: ${t})...`),(0,a.Ay)({url:`/doctor/get/${t}`,method:"get",retryTimes:3,timeout:15e3,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"},params:{_t:(new Date).getTime()}}).then((e=>(e?(console.log(`成功获取医生信息 (userId: ${t}):`,e),o.info.set(t,e),o.timestamp=Date.now()):console.warn(`医生信息返回空数据 (userId: ${t})`),e))).catch((e=>(0,a.tq)(e)?(console.log(`获取医生信息请求被取消 (userId: ${t})`),Promise.reject(e)):(console.error(`获取医生信息(ID: ${t})失败:`,e),Promise.reject(e))))):Promise.reject(new Error("用户ID不能为空"))}function s(t=2){return console.log("正在获取所有医生列表..."),o.reset(),(0,a.Ay)({url:"/doctor",method:"get",retryTimes:t,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"},params:{_t:(new Date).getTime()}}).then((t=>(t?(console.log(`成功获取${t.length||0}条医生数据`),t.length>0&&console.log("医生列表预览:",t.map((t=>({id:t.doctorId,name:t.doctorName,hospital:t.hospitalName,department:t.departmentName}))))):console.warn("获取医生列表返回空数据"),t))).catch((t=>(0,a.tq)(t)?(console.log("医生列表请求被取消"),Promise.reject(t)):"CanceledError"===t.name||"ERR_CANCELED"===t.code?(console.log("医生列表请求被取消 (CanceledError)"),Promise.reject(t)):(console.error("获取医生列表失败:",t),Promise.reject(t))))}function l(t){return(0,a.Ay)({url:"/doctor/page",method:"post",data:t}).catch((t=>((0,a.tq)(t)||console.error("分页获取医生列表失败:",t),Promise.reject(t))))}function c(t){return o.reset(),(0,a.Ay)({url:"/doctor/create",method:"post",data:t}).catch((t=>((0,a.tq)(t)||console.error("创建医生信息失败:",t),Promise.reject(t))))}},6319:function(t,e,r){var a=r(8551),o=r(9539);t.exports=function(t,e,r,n){try{return n?e(a(r)[0],r[1]):e(r)}catch(i){o(t,"throw",i)}}},2529:function(t){t.exports=function(t,e){return{value:t,done:e}}},6279:function(t,e,r){var a=r(6840);t.exports=function(t,e,r){for(var o in e)a(t,o,e[o],r);return t}},9462:function(t,e,r){var a=r(9565),o=r(2360),n=r(6699),i=r(6279),s=r(8227),l=r(1181),c=r(5966),u=r(7657).IteratorPrototype,d=r(2529),h=r(9539),p=s("toStringTag"),m="IteratorHelper",g="WrapForValidIterator",f=l.set,v=function(t){var e=l.getterFor(t?g:m);return i(o(u),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return d(void 0,!0);try{var a=r.nextHandler();return r.returnHandlerResult?a:d(a,r.done)}catch(o){throw r.done=!0,o}},return:function(){var r=e(this),o=r.iterator;if(r.done=!0,t){var n=c(o,"return");return n?a(n,o):d(void 0,!0)}if(r.inner)try{h(r.inner.iterator,"normal")}catch(i){return h(o,"throw",i)}return o&&h(o,"normal"),d(void 0,!0)}})},C=v(!0),y=v(!1);n(y,p,"Iterator Helper"),t.exports=function(t,e,r){var a=function(a,o){o?(o.iterator=a.iterator,o.next=a.next):o=a,o.type=e?g:m,o.returnHandlerResult=!!r,o.nextHandler=t,o.counter=0,o.done=!1,f(this,o)};return a.prototype=e?C:y,a}},713:function(t,e,r){var a=r(9565),o=r(9306),n=r(8551),i=r(1767),s=r(9462),l=r(6319),c=s((function(){var t=this.iterator,e=n(a(this.next,t)),r=this.done=!!e.done;if(!r)return l(t,this.mapper,[e.value,this.counter++],!0)}));t.exports=function(t){return n(this),o(t),new c(i(this),{mapper:t})}},1701:function(t,e,r){var a=r(6518),o=r(713),n=r(6395);a({target:"Iterator",proto:!0,real:!0,forced:n},{map:o})},1454:function(t,e,r){r(1701)}}]);